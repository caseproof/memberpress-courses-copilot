<!DOCTYPE html>
<html>
<head>
    <title>Simple Send Button Test</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <h1>Simple AI Chat Test</h1>
    
    <div style="border: 1px solid #ccc; padding: 20px; margin: 20px;">
        <h2>Test Configuration</h2>
        <p>AJAX URL: <input type="text" id="ajax-url" value="/wp-admin/admin-ajax.php" style="width: 300px;"></p>
        <p>Nonce: <input type="text" id="nonce" placeholder="Enter nonce from WordPress" style="width: 300px;"></p>
        <p><small>Get the nonce from WordPress admin or the test-send-button.php script</small></p>
    </div>
    
    <div style="border: 1px solid #ccc; padding: 20px; margin: 20px;">
        <h2>Send Test Message</h2>
        <textarea id="message" rows="3" style="width: 100%;">Hello, can you help me create a programming course?</textarea>
        <br><br>
        <button id="send-btn" style="padding: 10px 20px; background: #0073aa; color: white; border: none; cursor: pointer;">Send Message</button>
        
        <div id="output" style="margin-top: 20px; padding: 15px; background: #f5f5f5; min-height: 100px; white-space: pre-wrap;">
            <em>Response will appear here...</em>
        </div>
    </div>
    
    <div style="border: 1px solid #ccc; padding: 20px; margin: 20px;">
        <h2>Console Output</h2>
        <pre id="console" style="background: #000; color: #0f0; padding: 10px; height: 200px; overflow-y: auto; font-family: monospace;"></pre>
    </div>
    
    <script>
    // Simple console logging to page
    function log(message, data) {
        const timestamp = new Date().toLocaleTimeString();
        const logEntry = `[${timestamp}] ${message}${data ? '\n' + JSON.stringify(data, null, 2) : ''}\n`;
        document.getElementById('console').textContent += logEntry;
        console.log(message, data || '');
    }
    
    jQuery(document).ready(function($) {
        log('Page loaded, jQuery ready');
        
        $('#send-btn').on('click', function() {
            const ajaxUrl = $('#ajax-url').val();
            const nonce = $('#nonce').val();
            const message = $('#message').val();
            
            if (!nonce) {
                alert('Please enter a nonce value first!');
                return;
            }
            
            log('Sending AJAX request to: ' + ajaxUrl);
            $('#output').html('<em>Sending request...</em>');
            
            const requestData = {
                action: 'mpcc_ai_chat',
                nonce: nonce,
                message: message,
                context: 'course_creation'
            };
            
            log('Request data:', requestData);
            
            $.ajax({
                url: ajaxUrl,
                type: 'POST',
                data: requestData,
                dataType: 'json',
                success: function(response) {
                    log('Success response received:', response);
                    
                    if (response.success) {
                        $('#output').html(
                            '<strong style="color: green;">✓ Success!</strong>\n\n' +
                            '<strong>AI Response:</strong>\n' + 
                            response.data.message + '\n\n' +
                            '<strong>Full Response Data:</strong>\n' +
                            JSON.stringify(response.data, null, 2)
                        );
                    } else {
                        $('#output').html(
                            '<strong style="color: red;">✗ Error:</strong>\n' + 
                            (response.data || 'Unknown error') + '\n\n' +
                            '<strong>Full Response:</strong>\n' +
                            JSON.stringify(response, null, 2)
                        );
                    }
                },
                error: function(xhr, status, error) {
                    log('AJAX Error:', {status: status, error: error, responseText: xhr.responseText});
                    
                    $('#output').html(
                        '<strong style="color: red;">✗ AJAX Error:</strong>\n' +
                        'Status: ' + status + '\n' +
                        'Error: ' + error + '\n\n' +
                        'Response Text:\n' + xhr.responseText
                    );
                }
            });
        });
    });
    </script>
</body>
</html>